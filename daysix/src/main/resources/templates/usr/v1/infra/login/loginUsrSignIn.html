<!doctype html>
<html xmlns:th="https://www.thymeleaf.org">
<head>
	<!-- Basic Page Needs -->
    <meta charset="utf-8">
    <title>loginUsrSignIn</title>
    <meta name="description" content="A Template by Gozha.net">
    <meta name="keywords" content="HTML, CSS, JavaScript">
    <meta name="author" content="Gozha.net">
    
    <!-- Mobile Specific Metas-->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="telephone=no" name="format-detection">
    
    <!-- Fonts -->
    <!-- Font awesome - icon font -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- Roboto -->
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,700' rel='stylesheet' type='text/css'>
    
    <!-- Stylesheets -->
    
   	<!-- 0_style.css -->
    <link rel="stylesheet" href="/usr/v1/template/themeforest-1.0.0/css/0_style.css">

    <!-- Mobile menu -->
    <link href="/usr/v1/template/themeforest-1.0.0/css/gozha-nav.css" rel="stylesheet" />
    <!-- Select -->
    <link href="/usr/v1/template/themeforest-1.0.0/css/external/jquery.selectbox.css" rel="stylesheet" />

    <!-- Custom -->
    <link href="/usr/v1/template/themeforest-1.0.0/css/style.css?v=1" rel="stylesheet" />

    <!-- Modernizr --> 
    <script src="/usr/v1/template/themeforest-1.0.0/js/external/modernizr.custom.js"></script>

    <!-- Favicon -->
    <link rel="icon" href="/usr/v1/template/themeforest-1.0.0/0_images/favicon/img-cat.jpg">
    
    
</head>

<body>
    <div class="wrapper">
        <!-- Header section -->
        <header class="header-wrapper">
            <div class="container">
                <!-- Logo link-->
                <a href='/v1/infra/index/indexUsrView' class="logo">
                    <img alt='logo' src="/usr/v1/template/themeforest-1.0.0/images/logo.png">
                </a>
                
                <!-- Main website navigation-->
                <nav id="navigation-box">
				<!-- Toggle for mobile menu mode -->
					<a href="#" id="navigation-toggle">
				    	<span class="menu-icon">
				        <span class="icon-toggle" role="button" aria-label="Toggle Navigation">
				            <span class="lines"></span>
				        </span>
				    	</span>
					</a>
			
				<!-- Link navigation -->
				    <ul id="navigation">
				        <li>
				            <span class="sub-nav-toggle plus"></span>
				            <a href="/v1/infra/login/loginUsrSignIn">ë¡œê·¸ì¸</a>
				        </li>
				        <li>
				            <span class="sub-nav-toggle plus"></span>
				            <a href="/v1/infra/login/loginUsrSignUp">íšŒì›ê°€ì…</a>
				        </li>
				        <li>
				            <span class="sub-nav-toggle plus"></span>
				            <a href="/v1/infra/concert/concertUsrList">ì½˜ì„œíŠ¸</a>
				        </li>
				        <li>
				            <span class="sub-nav-toggle plus"></span>
				            <a href="#">ì½˜ì„œíŠ¸í‹°ì¼“</a>
				        </li>
				    </ul>
				</nav>
                
                <!-- Additional header buttons / Auth and direct link to booking-->
                <div class="control-panel">
                    <a href="#" class="btn btn--sign">ë¡œê·¸ì¸</a>
                    <a href="#" class="btn btn-md btn--warning btn--book">í‹°ì¼“ ì˜ˆë§¤</a>
                </div>

            </div>
        </header>
        
        <!-- Search bar -->
        <div class="search-wrapper">
            <div class="container container--add">
                <form id='search-form' method='get' class="search">
                    <input type="text" class="search__field" placeholder="ì°¾ê¸°">
                    <select name="sorting_item" id="search-sort" class="search__sort" tabindex="0">
                        <option value="1" selected='selected'>ì½˜ì„œíŠ¸</option>
                        <option value="2">ê°€ìˆ˜</option>
                        <option value="3">ì¥ë¥´</option>
                    </select>
                    <button type='submit' class="btn btn-md btn--danger search__button">ì½˜ì„œíŠ¸ ê²€ìƒ‰</button>
                </form>
            </div>
        </div>
        
        <!-- Main content -->
                <form id="form" class="login" method='post' novalidate='' action="/v1/infra/login/loginUsrSignIn">
                    <p class="login__title">ë¡œê·¸ì¸ <br><span class="login-edition">welcome to A.Movie</span></p>

                    <div class="social social--colored">
                            <a href='#' class="social__variant fa fa-facebook"></a>
                            <a href='#' class="social__variant fa fa-twitter"></a>
                            <a href='#' class="social__variant fa fa-tumblr"></a>
                    </div>

                    <p class="login__tracker">or</p>
                    
                    <div class="field-wrap">
                    	<label for="mmId">ì•„ì´ë””</label>
	                    <input type="text" placeholder='ì•„ì´ë””ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”' name='mmId' class="login__input" id="mmId" value="tackchun">
	                    <div class="invalidId">
		                    <p class="inv-em alert alert-danger">
		                    	<span class="icon-warning"></span>
		                    	ì•„ì´ë””ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”!
		                    	<a class="close" data-dismiss="alert" href="#" aria-hidden="true"></a>
		                    </p>
	                    </div>
	                    <div class="validId">
		                    <p class="inv-em alert alert-success">
		                    	<span class="icon-bell"></span>
		                    	ì°¸ ì˜í–ˆì–´ìš”!
		                    	<a class="close" data-dismiss="alert" href="#" aria-hidden="true"></a>
		                    </p>
	                    </div>
	                    <label for="mmPw">ë¹„ë°€ë²ˆí˜¸</label>
	                    <input type='password' placeholder='ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”' name='mmPw' class="login__input" id="mmPw" value="Tack123t#">
	                    <div class="invalidPw">
		                    <p class="inv-em alert alert-danger">
		                    	<span class="icon-warning"></span>
		                    	ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”!
		                    	<a class="close" data-dismiss="alert" href="#" aria-hidden="true"></a>
		                    </p>
	                    </div>
	                    <div class="validPw">
		                    <p class="inv-em alert alert-success">
		                    	<span class="icon-bell"></span>
		                    	ì°¸ ì˜í–ˆì–´ìš”!
		                    	<a class="close" data-dismiss="alert" href="#" aria-hidden="true"></a>
		                    </p>
	                    </div>
	
	                    <input type='checkbox' id='#informed' class='login__check styled'>
	                    <label for='#informed' class='login__check-info'>íšŒì›ì •ë³´ ê¸°ì–µí•˜ê¸°</label>
                    </div>
                    
                    <div class="login__control" style="margin-bottom:13px;">
                        <button type='button' class="btn btn-md btn--warning btn--wider" id="btnSignIn">ë¡œê·¸ì¸</button>
                    </div>
                    <a id="kakao-login-btn" href="javascript:loginWithKakao()">
					  <img src="https://k.kakaocdn.net/14/dn/btroDszwNrM/I6efHub1SN5KCJqLm1Ovx1/o.jpg" width="150" alt="ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ë²„íŠ¼">
					</a>
                </form>
                
        <div class="clearfix"></div>
        
        <th:block th:replace="~{usr/v1/infra/include/footer :: footer}"></th:block>
        
    </div>

    
    
    <!-- Modal S -->
   	<div class="overlay overlay-hugeinc">
    
        <section class="container">
    
            <div class="col-sm-4 col-sm-offset-4">
                <button type="button" class="overlay-close">Close</button>
                <form id="login-form" class="login" method='get' novalidate=''>
                    <p class="login__title">í™•ì¸</p>
    
                    <p class="login__tracker">ì¼ì¹˜í•˜ëŠ” íšŒì›ì´ ì¡´ì¬ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤!</p>
    
                    <div class="login__control">
                        <button type='button' class="btn btn-md btn--danger btn--wider">í™•ì¸</button>
                    </div>
                </form>
            </div>
    
        </section>
    </div>	
   	<!-- Modal E -->

	<!-- JavaScript-->
        <!-- jQuery 3.1.1--> 
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="/usr/v1/template/themeforest-1.0.0/js/external/jquery-3.1.1.min.js"><\/script>')</script>
        <!-- Migrate --> 
        <script src="/usr/v1/template/themeforest-1.0.0/js/external/jquery-migrate-1.2.1.min.js"></script>
        <!-- Bootstrap 3--> 
        <script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.2/js/bootstrap.min.js"></script>

        <!-- Mobile menu -->
        <script src="/usr/v1/template/themeforest-1.0.0/js/jquery.mobile.menu.js"></script>
         <!-- Select -->
        <script src="/usr/v1/template/themeforest-1.0.0/js/external/jquery.selectbox-0.2.min.js"></script>
        <!-- Form element -->
        <script src="/usr/v1/template/themeforest-1.0.0/js/external/form-element.js"></script>
        <!-- Form validation -->
        <script src="/usr/v1/template/themeforest-1.0.0/js/form.js"></script>

        <!-- Custom -->
        <script src="/usr/v1/template/themeforest-1.0.0/js/custom.js"></script>
        
        <!-- btnSignIn S -->
        <script type="text/javascript">
        document.getElementById("btnSignIn").onclick = function() {
        //  validation
        //  ì•„ì´ë””
        	var mmId = document.getElementById("mmId");
        	var mmIdValue = document.getElementById("mmId").value.trim();
        	var invalidId = document.querySelector('.invalidId');
        	var validId = document.querySelector('.validId');
        	var mmIdRegExp = /^[ã„±-ã…ê°€-í£A-Za-z0-9]{4,10}$/;
        	
        	if(mmIdValue == '' || mmIdValue == null) {
        		mmId.style.borderColor = '#fe505a';
        		invalidId.style.display = 'block';
        		validId.style.display = 'none';
        		mmId.focus();
        		return false;
        	} else {
        		mmId.style.borderColor = '#92DA7F';
        		invalidId.style.display = 'none';
        		validId.style.display = 'block';
        	}
        	
        	if(!mmIdRegExp.test(mmIdValue)) {
        		mmId.style.borderColor = '#fe505a';
        		invalidId.style.display = 'block';
        		validId.style.display = 'none';
        		const messageElement = document.querySelector('.invalidId .inv-em');
        		messageElement.childNodes[2].textContent = 'í•œê¸€, ì˜ëŒ€ì†Œë¬¸ì, ìˆ«ì, 4~10ìë¦¬';
        		mmId.focus();
        		return false;
        	} else {
        		invalidId.style.display = 'none';
        		validId.style.display = 'block';
        	}
                		
        //  ë¹„ë°€ë²ˆí˜¸
        	var mmPw = document.getElementById("mmPw");
        	var mmPwValue = document.getElementById("mmPw").value.trim();
        	var invalidPw = document.querySelector('.invalidPw');
        	var validPw = document.querySelector('.validPw');
        	var mmPwRegExp = /^.*(?=^.{8,15}$)(?=.*\d)(?=.*[a-zA-Z])(?=.*[!@#$%^&+=]).*$/;
        	
        	if(mmPwValue == '' || mmPwValue == null) {
        		mmPw.style.borderColor = '#fe505a';
        		invalidPw.style.display = 'block';
        		validPw.style.display = 'none';
        		mmPw.focus();
        		return false;
        	} else {
        		mmPw.style.borderColor = '#92DA7F';
        		invalidPw.style.display = 'none';
        		validPw.style.display = 'block';
        	}
        	
        	if(!mmPwRegExp.test(mmPwValue)) {
        		mmPw.style.borderColor = '#fe505a';
        		invalidPw.style.display = 'block';
        		validPw.style.display = 'none';
        		const messageElement = document.querySelector('.invalidPw .inv-em');
        		messageElement.childNodes[2].textContent = 'ì˜ëŒ€ì†Œë¬¸ì, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ì ì¡°í•© 8~15ìë¦¬';
        		mmPw.focus();
        		return false;
        	} else {
        		invalidPw.style.display = 'none';
        		validPw.style.display = 'block';
        	}

        	$.ajax({
        		async: true 
        		,cache: false
        		,type: "post"
        		/* ,dataType:"json" */
        		,url: "/v1/infra/member/signinUsrProc"
        		/* ,data : $("#formLogin").serialize() */
        		,data : { "mmId" : $("#mmId").val(), "mmPw" : $("#mmPw").val()}
        		,success: function(response) {
        			if(response.rt == "success") {
        				if(response.changePwd == "true") {
        					location.href = "/v1/infra/index/indexUsrView";
        				} else {
        					location.href = "/v1/infra/index/indexUsrView";
        				}
        			} else {
//             			validation
        		 		mmId.style.borderColor = '#ff3e1d';
        		 		mmPw.style.borderColor = '#ff3e1d';
        		 		invalidId.style.display = 'block';
        		 		invalidPw.style.display = 'block';
        		 		validId.style.display = 'none';
        		 		validPw.style.display = 'none';
        		 		const messageElementId = document.querySelector('.invalidId .inv-em');
        		 		messageElementId.childNodes[2].textContent = 'ì¼ì¹˜í•˜ëŠ” íšŒì›ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤!';
        		 		const messageElementPw = document.querySelector('.invalidPw .inv-em');
        		 		messageElementPw.childNodes[2].textContent = 'ì¼ì¹˜í•˜ëŠ” íšŒì›ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤!';
        		 		
        				
        			}
        		}
        		,error : function(jqXHR, textStatus, errorThrown){
        			alert("ajaxUpdate " + jqXHR.textStatus + " : " + jqXHR.errorThrown);
        		}
        	});
                		
        }
        </script>
        <!-- btnSignIn E -->
        
        <script type="text/javascript">
	        document.addEventListener("keypress", function(event) {
		        if (event.key === "Enter") {
		            document.getElementById("btnSignIn").click();
		        }
		    });
        </script>
        
        <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
        <script type="text/javascript">

	        // ì¹´ì¹´ì˜¤ SDK ì´ˆê¸°í™”
	        Kakao.init('0546a9953a7fe11920be0f6f364412e5'); 
	        console.log(Kakao.isInitialized());
	
	        // ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í•¨ìˆ˜
	        function loginWithKakao() {
	          Kakao.Auth.authorize({
	            redirectUri: 'http://localhost:8080/v1/infra/index/indexUsrView',
	          });
	        }
	
	        // ë¡œê·¸ì¸ ì„±ê³µ í›„ í† í° í™•ì¸ ë° ë©”ì‹œì§€ ì „ì†¡
	        function displayToken() {
	          var token = getCookie('authorize-access-token');
	
	          if (token) {
	            Kakao.Auth.setAccessToken(token);
	            Kakao.Auth.getStatusInfo()
	              .then(function (res) {
	                if (res.status === 'connected') {
	                  document.getElementById('token-result').innerText =
	                    'login success, token: ' + Kakao.Auth.getAccessToken();
	                  
	                  // ì—¬ê¸°ì„œ ë©”ì‹œì§€ APIë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.
	                  sendKakaoMessage();
	                }
	              })
	              .catch(function (err) {
	                console.error(err);
	                Kakao.Auth.setAccessToken(null);
	              });
	          }
	        }
	
	        // ì¹´ì¹´ì˜¤ ë©”ì‹œì§€ ë³´ë‚´ê¸° í•¨ìˆ˜
	        function sendKakaoMessage() {
	          Kakao.API.request({
	            url: '/v2/api/talk/memo/default/send',
	            data: {
	              template_object: {
	                object_type: 'text',
	                text: 'ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ì— ì„±ê³µí–ˆìŠµë‹ˆë‹¤! ğŸ‰',
	                link: {
	                  web_url: '/usr/v1/infra/index/indexUsrView', // ì´ë™í•  URL
	                  mobile_web_url: '/usr/v1/infra/index/indexUsrView'
	                }
	              }
	            }
	          })
	            .then(function (res) {
	              console.log('ë©”ì‹œì§€ ì „ì†¡ ì„±ê³µ', res);
	              alert('ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ë¡œê·¸ì¸ ì•Œë¦¼ ë©”ì‹œì§€ë¥¼ ë³´ëƒˆìŠµë‹ˆë‹¤!');
	            })
	            .catch(function (err) {
	              console.error('ë©”ì‹œì§€ ì „ì†¡ ì‹¤íŒ¨', err);
	              alert('ë©”ì‹œì§€ ì „ì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
	            });
	        }
	
	        // ì¿ í‚¤ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
	        function getCookie(name) {
	          var parts = document.cookie.split(name + '=');
	          if (parts.length === 2) {
	            return parts[1].split(';')[0];
	          }
	        }
	
	        // ì—”í„°í‚¤ ë¡œê·¸ì¸ ë²„íŠ¼ í™œì„±í™”
	        document.addEventListener('keydown', function (event) {
	          if (event.key == 'Enter') {
	            document.getElementById('btnLogin').click();
	          }
	        });
        </script>
        
</body>
</html>
